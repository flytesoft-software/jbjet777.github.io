"use strict";class UmbraWorker{constructor(){function a(g){f=new EclipseData(JSON.parse(g))}function b(g){var h=new EclipseData(JSON.parse(g.eclipse)),j=parseInt(g.dateOffset),k=null,l=null,m=h.getPenumbraStartTime(),n=h.getPenumbraEndTime(),o=!1,p=null;if(("Annular"===h.type||"Total"===h.type||"Hybrid"===h.type)&&(o=!0),o)var q=h.getUmbraStartTime(),r=h.getUmbraEndTime();for(isNaN(j)&&(j=0);go;)p=new Date,p.setTime(p.getTime()+j),p>=m&&p<=n&&(k=h.drawPenumbraShadow(p)),o&&p.getTime()>=q&&p.getTime()<=r&&(l=h.drawUmbraShadow(p)),postMessage({cmd:"shadow_done",pen_shadow:JSON.stringify(k),umb_shadow:JSON.stringify(l),date:p.toUTCString()});go=!0}function c(g){if(g){for(var h=[],j=1;j<g.length;j++){h.push(g[j-1]);for(var k=new arc.GreatCircle({x:g[j-1].longitude,y:g[j-1].latitude},{x:g[j].longitude,y:g[j].latitude}),l=k.Arc(20,{offset:10}),m=0;m<l.geometries.length;m++)for(var n=0;n<l.geometries[m].coords.length;n++)h.push(new PositionObj(l.geometries[m].coords[n][1],l.geometries[m].coords[n][0]))}return h}return null}function d(g){var h=parseFloat(g),j=c(f.drawUmbraShadow(h));postMessage({cmd:"shadow_done",umb_shadow:JSON.stringify(j)})}importScripts("SolarElevation.js"),importScripts("EclipseCalc.js"),importScripts("arc.js");var f=null;self.addEventListener("message",function(g){var h=g.data;switch(h.cmd){case"eclipse":a(h.eclipse);break;case"shadow":d(h.time);break;case"real":b(h.time);break;default:console.log("ANIMATE WORKER: Unkown command sent to worker.");}},!1)}}(function(){console.log("UMBRA WORKER: Initialized.");new UmbraWorker})();